<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tu Calculadora Interactiva de D√≠as de Descanso Anuales</title>
    <!-- Link to Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Link to Chart.js for charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Link to Google Fonts for Inter font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <!-- Embedded custom CSS styles -->
    <style>
        /* style.css */

        body { font-family: 'Inter', sans-serif; }
        .active-tab {
            background-color: #E4002B; /* UGT Red */
            color: white;
            border-color: #E4002B;
        }
        .inactive-tab {
            background-color: #f0f4f8; /* Lighter slate for inactive */
            color: #334155;
            border-color: #cbd5e1; /* Slate border */
        }
        .nav-btn:hover:not(.active-tab) {
            background-color: #fecaca; /* Light red on hover for inactive */
            color: #E4002B;
            border-color: #E4002B;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 350px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        /* UGT Red */
        .ugt-bg-red {
            background-color: #E4002B; /* A common UGT red */
        }
        .ugt-text-red {
            color: #E4002B;
        }
        .ugt-border-red {
            border-color: #E4002B;
        }
        .ugt-accent-bg {
            background-color: #fef2f2; /* Very light red for accents */
        }
        .ugt-accent-border {
            border-color: #fca5a5; /* Light red border */
        }
        /* Custom style for range input thumb and track color */
        input[type="range"]::-webkit-slider-thumb {
            background-color: #E4002B; /* UGT Red */
        }
        input[type="range"]::-moz-range-thumb {
            background-color: #E4002B; /* UGT Red */
        }
        input[type="range"]::-ms-thumb {
            background-color: #E4002B; /* UGT Red */
        }
        input[type="range"]::-webkit-slider-runnable-track {
            background-color: #fca5a5; /* Light red track */
        }
        input[type="range"]::-moz-range-track {
            background-color: #fca5a5; /* Light red track */
        }
        input[type="range"]::-ms-track {
            background-color: #fca5a5; /* Light red track */
        }

        /* Styles for the highlighted "Resumen Global" button */
        .highlight-nav-btn {
            background-color: #E4002B; /* UGT Red */
            color: white;
            border-color: white; /* White border for emphasis */
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
            width: 100%; /* Make it full width on small screens */
        }
        .highlight-nav-btn:hover {
            background-color: #c20025; /* Darker red on hover */
            border-color: white;
            transform: translateY(-1px);
        }
        /* On medium screens and up, let it behave like other buttons in terms of width */
        @media (min-width: 768px) {
            .highlight-nav-btn {
                width: auto; /* Revert to auto width on larger screens */
            }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto p-4 md:p-8">
        
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-5xl font-extrabold ugt-text-red mb-4 leading-tight flex flex-col md:flex-row items-center justify-center gap-2 md:gap-4">
                <img src="https://placehold.co/60x60/E4002B/FFFFFF?text=UGT" alt="Logotipo de UGT Sanidad Salamanca" class="h-12 w-12 md:h-16 md:w-16 rounded-full border-4 border-white shadow-md">
                <span class="block">UGT Sanidad Salamanca</span>
                <span class="block text-teal-700 text-xl md:text-3xl font-bold mt-0 md:mt-2">Tu Calculadora Interactiva de D√≠as de Descanso Anuales</span>
            </h1>
            <p class="text-slate-700 max-w-3xl mx-auto text-lg">Explora de forma sencilla tu jornada, vacaciones y permisos, y entiende c√≥mo se registran en la aplicaci√≥n AIDA. ¬°Defendemos tus derechos!</p>
        </header>

        <nav class="flex flex-wrap justify-center gap-2 md:gap-4 mb-8">
            <!-- Moved Resumen Global to the first position and applied highlight class -->
            <button id="btn-resumen-global" class="nav-btn active-tab highlight-nav-btn text-sm md:text-base font-semibold py-2 px-4 rounded-lg border transition-colors duration-300 shadow-sm" data-tab="resumen-global">‚ú® Resumen Global</button>
            <button id="btn-jornada" class="nav-btn inactive-tab text-sm md:text-base font-semibold py-2 px-4 rounded-lg border transition-colors duration-300 shadow-sm" data-tab="jornada">üï∞Ô∏è Jornada</button>
            <button id="btn-vacaciones" class="nav-btn inactive-tab text-sm md:text-base font-semibold py-2 px-4 rounded-lg border transition-colors duration-300 shadow-sm" data-tab="vacaciones">‚úàÔ∏è Vacaciones</button>
            <button id="btn-libre-disposicion" class="nav-btn inactive-tab text-sm md:text-base font-semibold py-2 px-4 rounded-lg border transition-colors duration-300 shadow-sm" data-tab="libre-disposicion">üóìÔ∏è D√≠as Libre Disposici√≥n</button>
            <button id="btn-permisos" class="nav-btn inactive-tab text-sm md:text-base font-semibold py-2 px-4 rounded-lg border transition-colors duration-300 shadow-sm" data-tab="permisos">üìã Permisos</button>
            <button id="btn-codigos" class="nav-btn inactive-tab text-sm md:text-base font-semibold py-2 px-4 rounded-lg border transition-colors duration-300 shadow-sm" data-tab="codigos">üîç C√≥digos AIDA</button>
        </nav>

        <main id="main-content">

            <!-- SECCI√ìN JORNADA -->
            <section id="tab-jornada" class="tab-content hidden bg-white p-6 rounded-xl shadow-lg">
                <h2 class="text-2xl font-bold ugt-text-red mb-4">Tu Jornada Laboral</h2>
                <p class="text-slate-600 mb-6">Esta secci√≥n resume los aspectos clave de tu jornada de trabajo en SACYL, desde el c√≥mputo de horas anual hasta la gesti√≥n de turnos. El objetivo es que conozcas las reglas fundamentales que estructuran tu d√≠a a d√≠a laboral y c√≥mo el sistema AIDA las registra.</p>
                
                <div class="grid md:grid-cols-2 gap-6 mb-8">
                    <div class="ugt-accent-bg p-4 rounded-lg ugt-border-red border-l-4">
                        <h3 class="font-bold text-lg mb-2 text-slate-800">Jornada Ordinaria Anual (Diurna)</h3>
                        <p class="text-4xl font-bold ugt-text-red">1.533 <span class="text-2xl font-semibold text-slate-500">horas</span></p>
                        <p class="text-slate-500 mt-1">Para el personal con turno de ma√±anas fijas o en Atenci√≥n Primaria, la jornada anual se calcula de la siguiente manera:</p>
                        <p class="text-slate-500 mt-1">Se parte de los <span class="font-semibold ugt-text-red">365</span> d√≠as del a√±o, a los que se restan <span class="font-semibold ugt-text-red">104</span> d√≠as (s√°bados y domingos), <span class="font-semibold ugt-text-red">14</span> festivos, <span class="font-semibold ugt-text-red">22</span> d√≠as de vacaciones y <span class="font-semibold ugt-text-red">6</span> d√≠as de libre disposici√≥n, resultando en <span class="font-semibold ugt-text-red">219</span> d√≠as de trabajo efectivo.</p>
                        <p class="text-slate-500 mt-1">Este resultado se multiplica por <span class="font-semibold ugt-text-red">7</span> horas por jornada, y se suman <span class="font-semibold ugt-text-red">14</span> horas a compensar por los d√≠as 24 y 31 de diciembre (si procede), determinando as√≠ la jornada anual para <span class="font-semibold ugt-text-red">2025.</span></p>
                    </div>
                    <div class="ugt-accent-bg p-4 rounded-lg ugt-border-red border-l-4">
                        <h3 class="font-bold text-lg mb-2 text-slate-800">Reglas Clave</h3>
                        <ul class="list-disc list-inside space-y-2 text-slate-700">
                            <li>El <span class="font-semibold ugt-text-red">exceso de horas</span> se compensa con descanso, no econ√≥micamente.</li>
                            <li>Como norma general, si solicitas un <span class="font-semibold ugt-text-red">permiso</span> deben confirmarte su disfrute dentro de la semana siguiente a tu solicitud.</li>
                            <li>Las <span class="font-semibold ugt-text-red">vacaciones</span> se deben solicitar antes del 30 de abril del a√±o en curso.</li>
                            <li>A los trabajadores con contrato en vigor que comprenda los d√≠as 24 y 31 de diciembre les corresponden <span class="font-semibold ugt-text-red">7 horas</span> por cada uno de estos d√≠as.</li>
                            <li>A los trabajadores con turno de ma√±anas fijas de lunes a viernes se les a√±ade <span class="font-semibold ugt-text-red">un d√≠a</span> por cada s√°bado festivo en el a√±o en curso.</li>
                        </ul>
                    </div>
                </div>

                <div class="ugt-accent-bg p-4 rounded-lg mb-8 ugt-border-red border-l-4">
                    <h3 class="font-bold text-lg mb-2 text-slate-800">Calculadora de Jornada por Noches Anuales (2025)</h3>
                    <p class="text-slate-600 mb-4">Introduce el n√∫mero de noches anuales trabajadas para ver c√≥mo afecta tu c√≥mputo de jornada anual, seg√∫n la tabla oficial para el personal de turno rotatorio o nocturno de 2025.</p>
                    <label for="night-shifts-input" class="block font-semibold text-slate-700 mb-2">N√∫mero de Noches Anuales (1-142):</label>
                    <input type="number" id="night-shifts-input" min="0" max="142" value="0" class="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-ugt-text-red focus:border-ugt-text-red transition">
                    <div class="mt-4 text-center bg-white p-4 rounded-md shadow-sm">
                        <p class="text-slate-600">Tu jornada anual ajustada es:</p>
                        <p id="adjusted-annual-hours" class="text-4xl font-bold ugt-text-red">1.533 <span class="text-2xl font-semibold text-slate-500">horas</span></p>
                        <p id="night-shift-message" class="text-sm text-slate-500 mt-2"></p>
                    </div>
                </div>

                <div>
                    <h3 class="font-bold text-lg mb-4 text-center ugt-text-red">Tipos de Turno y sus C√≥digos AIDA</h3>
                    <div id="shift-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 text-center">
                    </div>
                </div>
            </section>

            <!-- SECCI√ìN VACACIONES -->
            <section id="tab-vacaciones" class="tab-content hidden bg-white p-6 rounded-xl shadow-lg">
                 <h2 class="text-2xl font-bold ugt-text-red mb-4">Tus Vacaciones</h2>
                <p class="text-slate-600 mb-6">Aqu√≠ puedes calcular los d√≠as de vacaciones que te corresponden seg√∫n tu antig√ºedad y visualizar c√≥mo se componen. Adem√°s, encontrar√°s las reglas principales sobre c√≥mo y cu√°ndo puedes disfrutarlas, junto con los c√≥digos que utiliza AIDA para gestionarlas.</p>
                
                <div class="grid lg:grid-cols-2 gap-8 items-center">
                    <div>
                        <h3 class="font-bold text-lg mb-4 text-slate-800">Calculadora de D√≠as por Antig√ºedad</h3>
                        <div class="ugt-accent-bg p-4 rounded-lg ugt-border-red border-l-4">
                            <label for="antiquity-slider" class="block font-semibold text-slate-700 mb-2">A√±os de servicio en SACYL:</label>
                            <input type="range" id="antiquity-slider" min="0" max="50" value="10" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-ugt-red">
                            <div id="vacation-slider-labels" class="flex justify-between text-xs text-slate-500 mt-1">
                                <!-- Labels will be dynamically inserted here by JavaScript -->
                            </div>
                            <div class="mt-4 text-center bg-white p-4 rounded-md shadow-sm">
                                <p class="text-slate-600">Con <span id="vacation-antiquity-years" class="font-bold ugt-text-red">10</span> a√±os de servicio, te corresponden:</p>
                                <p id="total-vacation-days" class="text-4xl font-bold ugt-text-red">22 <span class="text-2xl font-semibold text-slate-500">d√≠as</span></p>
                            </div>
                        </div>

                        <h3 class="font-bold text-lg mb-4 mt-8 text-slate-800">Reglas Clave de Disfrute</h3>
                        <ul class="list-disc list-inside space-y-2 text-slate-700 ugt-accent-bg p-4 rounded-lg ugt-border-red border-l-4">
                           <li>Base de <span class="font-semibold ugt-text-red">22 d√≠as h√°biles</span> anuales.</li>
                           <li>Fraccionamiento en hasta <span class="font-semibold ugt-text-red">4 periodos</span> (m√≠nimo 7 d√≠as consecutivos por periodo).</li>
                           <li>Disfrute dentro del a√±o natural o <span class="font-semibold ugt-text-red">hasta el 15 de enero</span> del siguiente.</li>
                           <li>No son compensables econ√≥micamente (salvo fin de contrato).</li>
                           <li>Las <span class="font-semibold ugt-text-red">vacaciones por antig√ºedad</span> no descuentan horas del c√≥mputo anual de jornada.</li>
                        </ul>
                    </div>
                    <div>
                         <h3 class="font-bold text-lg mb-4 text-center ugt-text-red">Composici√≥n de tus Vacaciones</h3>
                         <div class="chart-container">
                            <canvas id="vacation-chart"></canvas>
                        </div>
                        <h3 class="font-bold text-lg mb-2 mt-6 text-center ugt-text-red">C√≥digos AIDA de Vacaciones</h3>
                        <div id="vacation-codes-grid" class="grid grid-cols-2 gap-2 text-xs text-center">
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECCI√ìN D√çAS DE LIBRE DISPOSICI√ìN -->
            <section id="tab-libre-disposicion" class="tab-content hidden bg-white p-6 rounded-xl shadow-lg">
                <h2 class="text-2xl font-bold ugt-text-red mb-4">Tus D√≠as de Libre Disposici√≥n</h2>
                <p class="text-slate-600 mb-6">Calcula tus d√≠as de libre disposici√≥n y los adicionales por antig√ºedad. Entiende c√≥mo se componen y las reglas para su disfrute, junto con sus c√≥digos en AIDA.</p>
                
                <div class="grid lg:grid-cols-2 gap-8 items-center">
                    <div>
                        <h3 class="font-bold text-lg mb-4 text-slate-800">Calculadora de D√≠as por Antig√ºedad</h3>
                        <div class="ugt-accent-bg p-4 rounded-lg ugt-border-red border-l-4">
                            <label for="antiquity-slider-ld" class="block font-semibold text-slate-700 mb-2">A√±os de servicio en SACYL:</label>
                            <input type="range" id="antiquity-slider-ld" min="0" max="50" value="10" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-ugt-red">
                            <div id="ld-slider-labels" class="flex justify-between text-xs text-slate-500 mt-1">
                                <!-- Labels will be dynamically inserted here by JavaScript -->
                            </div>
                            <div class="mt-4 text-center bg-white p-4 rounded-md shadow-sm">
                                <p class="text-slate-600">Con <span id="ld-antiquity-years" class="font-bold ugt-text-red">10</span> a√±os de servicio, te corresponden:</p>
                                <p id="total-ld-days" class="text-4xl font-bold ugt-text-red">6 <span class="text-2xl font-semibold text-slate-500">d√≠as</span></p>
                            </div>
                        </div>

                        <h3 class="font-bold text-lg mb-4 mt-8 text-slate-800">Reglas Clave de Disfrute</h3>
                        <ul class="list-disc list-inside space-y-2 text-slate-700 ugt-accent-bg p-4 rounded-lg ugt-border-red border-l-4">
                           <li>Base de <span class="font-semibold ugt-text-red">6 d√≠as laborables</span> anuales.</li>
                           <li>D√≠as adicionales por antig√ºedad: se a√±aden <span class="font-semibold ugt-text-red">2 d√≠as</span> a partir del 6¬∫ trienio (18 a√±os), y se suma <span class="font-semibold ugt-text-red">1 d√≠a adicional por cada trienio</span> cumplido a partir del 8¬∫ trienio (24 a√±os y siguientes).</li>
                           <li>Disfrute a lo largo del a√±o y <span class="font-semibold ugt-text-red">hasta el 31 de enero</span> del a√±o siguiente.</li>
                           <li>Sujeto a las necesidades del servicio.</li>
                           <li>Los <span class="font-semibold ugt-text-red">d√≠as de libre disposici√≥n por trienios</span> no descuentan horas del c√≥mputo anual de jornada.</li>
                        </ul>
                    </div>
                    <div>
                         <h3 class="font-bold text-lg mb-4 text-center ugt-text-red">Composici√≥n de tus D√≠as de Libre Disposici√≥n</h3>
                         <div class="chart-container">
                            <canvas id="ld-chart"></canvas>
                        </div>
                        <h3 class="font-bold text-lg mb-2 mt-6 text-center ugt-text-red">C√≥digos AIDA de Libre Disposici√≥n</h3>
                        <div id="ld-codes-grid" class="grid grid-cols-2 gap-2 text-xs text-center">
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECCI√ìN PERMISOS -->
            <section id="tab-permisos" class="tab-content hidden bg-white p-6 rounded-xl shadow-lg">
                <h2 class="text-2xl font-bold ugt-text-red mb-4">Gu√≠a de Permisos y Licencias</h2>
                <p class="text-slate-600 mb-6">El cat√°logo de permisos es extenso. Utiliza los filtros por categor√≠a o el buscador para encontrar r√°pidamente el permiso que te interesa. Cada tarjeta resume las condiciones clave y muestra el c√≥digo AIDA correspondiente para que puedas identificarlo f√°cilmente en tu ficha de incidencias.</p>
                
                <div class="flex flex-col md:flex-row gap-4 mb-6">
                    <div class="relative flex-grow">
                         <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400">üîç</span>
                        <input type="text" id="permit-search" placeholder="Buscar permiso (ej: paternidad, mudanza...)" class="w-full p-2 pl-10 border border-slate-300 rounded-lg focus:ring-2 focus:ring-ugt-text-red focus:border-ugt-text-red transition">
                    </div>
                    <div class="flex-shrink-0">
                        <select id="permit-category-filter" class="w-full md:w-auto p-2 border border-slate-300 rounded-lg bg-white focus:ring-2 focus:ring-ugt-text-red focus:border-ugt-text-red transition">
                            <option value="all">Todas las categor√≠as</option>
                            <option value="familiares">Familiares</option>
                            <option value="personales">Personales</option>
                            <option value="salud">Salud</option>
                            <option value="formacion">Formaci√≥n y Deberes</option>
                            <option value="sindicales">Sindicales</option>
                            <option value="compensatorios">Compensatorios</option>
                        </select>
                    </div>
                </div>

                <div id="permit-list" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                </div>
            </section>
            
            <!-- SECCI√ìN C√ìDIGOS AIDA -->
            <section id="tab-codigos" class="tab-content hidden bg-white p-6 rounded-xl shadow-lg">
                <h2 class="text-2xl font-bold ugt-text-red mb-4">Explorador de C√≥digos AIDA</h2>
                 <p class="text-slate-600 mb-6">Esta secci√≥n funciona como un diccionario de todos los c√≥digos de incidencias que utiliza la aplicaci√≥n AIDA. Si ves un c√≥digo en tu ficha y no sabes qu√© significa, puedes usar el buscador para encontrar su definici√≥n r√°pidamente.</p>
                <div class="relative mb-6">
                    <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400">üîç</span>
                    <input type="text" id="aida-code-search" placeholder="Buscar por c√≥digo o descripci√≥n..." class="w-full p-2 pl-10 border border-slate-300 rounded-lg focus:ring-2 focus:ring-ugt-text-red focus:border-ugt-text-red transition">
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left text-slate-600">
                        <thead class="text-xs ugt-text-red uppercase ugt-accent-bg rounded-t-lg">
                            <tr>
                                <th scope="col" class="px-6 py-3">C√≥digo</th>
                                <th scope="col" class="px-6 py-3">Descripci√≥n</th>
                                <th scope="col" class="px-6 py-3">Categor√≠a</th>
                                <th scope="col" class="px-6 py-3">Compensaci√≥n</th>
                            </tr>
                        </thead>
                        <tbody id="aida-code-table-body">
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- SECCI√ìN RESUMEN GLOBAL -->
            <section id="tab-resumen-global" class="tab-content bg-white p-6 rounded-xl shadow-lg">
                <h2 class="text-2xl font-bold ugt-text-red mb-4">Resumen Global de D√≠as de Descanso Anuales</h2>
                <p class="text-slate-600 mb-6">Aqu√≠ puedes ver el total de d√≠as de vacaciones y d√≠as de libre disposici√≥n que te corresponden anualmente, basado en los a√±os de servicio que selecciones en las pesta√±as anteriores. Adem√°s, puedes introducir los d√≠as ya disfrutados o solicitados para calcular los d√≠as restantes.</p>
                
                <div class="ugt-accent-bg p-4 rounded-lg ugt-border-red border-l-4 mb-6">
                    <h3 class="font-bold text-lg mb-4 text-slate-800">Selecciona tus A√±os de Servicio</h3>
                    <label for="summary-antiquity-slider" class="block font-semibold text-slate-700 mb-2">A√±os de servicio en SACYL:</label>
                    <input type="range" id="summary-antiquity-slider" min="0" max="50" value="10" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-ugt-red">
                    <div id="summary-slider-labels" class="flex justify-between text-xs text-slate-500 mt-1">
                        <!-- Labels will be dynamically inserted here by JavaScript -->
                    </div>
                </div>

                <div class="ugt-accent-bg p-6 rounded-lg text-center ugt-border-red border-l-4 mb-6">
                    <p class="text-slate-600 text-lg mb-4">Para <span id="summary-antiquity-years" class="font-bold ugt-text-red">10</span> a√±os de servicio:</p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="bg-white p-4 rounded-md shadow-sm">
                            <p class="text-sm text-slate-500">Vacaciones Totales:</p>
                            <p id="summary-vacation-days" class="text-3xl font-bold ugt-text-red">22</p>
                            <p class="text-sm text-slate-500">d√≠as</p>
                        </div>
                        <div class="bg-white p-4 rounded-md shadow-sm">
                            <p class="text-sm text-slate-500">Libre Disposici√≥n Total:</p>
                            <p id="summary-ld-days" class="text-3xl font-bold ugt-text-red">6</p>
                            <p class="text-sm text-slate-500">d√≠as</p>
                        </div>
                        <div class="ugt-bg-red p-4 rounded-md shadow-md text-white">
                            <p class="text-sm">Total D√≠as de Descanso Restantes:</p>
                            <p id="summary-total-days" class="text-4xl font-bold">28</p>
                            <p class="text-sm">d√≠as</p>
                        </div>
                    </div>
                    <p class="text-sm text-slate-500">Este total incluye tus d√≠as de vacaciones base, los adicionales por antig√ºedad, y tus d√≠as de libre disposici√≥n base m√°s los adicionales por trienios.</p>
                </div>

                <div class="ugt-accent-bg p-6 rounded-lg ugt-border-red border-l-4">
                    <h3 class="font-bold text-lg mb-4 text-slate-800">D√≠as Disfrutados / Restantes</h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <!-- Vacaciones Section -->
                        <div class="bg-white p-4 rounded-md shadow-sm">
                            <h4 class="font-bold text-slate-800 mb-3">Vacaciones</h4>
                            <label for="vacation-base-taken-input" class="block font-semibold text-slate-700 mb-2">Base ya disfrutadas/solicitadas:</label>
                            <input type="number" id="vacation-base-taken-input" min="0" value="0" class="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-ugt-text-red focus:border-ugt-text-red transition">
                            <div class="mt-3 text-center">
                                <p class="text-slate-600">Restantes (Base):</p>
                                <p id="vacation-base-remaining-days" class="text-2xl font-bold ugt-text-red">0 d√≠as</p>
                            </div>

                            <label for="vacation-antiquity-taken-input" class="block font-semibold text-slate-700 mt-4 mb-2">Antig√ºedad ya disfrutadas/solicitadas:</label>
                            <input type="number" id="vacation-antiquity-taken-input" min="0" value="0" class="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-ugt-text-red focus:border-ugt-text-red transition">
                            <div class="mt-3 text-center">
                                <p class="text-slate-600">Restantes (Antig√ºedad):</p>
                                <p id="vacation-antiquity-remaining-days" class="text-2xl font-bold ugt-text-red">0 d√≠as</p>
                            </div>
                            <div class="mt-4 pt-4 border-t border-slate-200 text-center">
                                <p class="text-slate-600">Total Vacaciones Restantes:</p>
                                <p id="vacation-total-remaining-days" class="text-3xl font-bold ugt-text-red">0 d√≠as</p>
                            </div>
                        </div>

                        <!-- Libre Disposici√≥n Section -->
                        <div class="bg-white p-4 rounded-md shadow-sm">
                            <h4 class="font-bold text-slate-800 mb-3">Libre Disposici√≥n</h4>
                            <label for="ld-base-taken-input" class="block font-semibold text-slate-700 mb-2">Base ya disfrutadas/solicitadas:</label>
                            <input type="number" id="ld-base-taken-input" min="0" value="0" class="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-ugt-text-red focus:border-ugt-text-red transition">
                            <div class="mt-3 text-center">
                                <p class="text-slate-600">Restantes (Base):</p>
                                <p id="ld-base-remaining-days" class="text-2xl font-bold ugt-text-red">0 d√≠as</p>
                            </div>

                            <label for="ld-trienios-taken-input" class="block font-semibold text-slate-700 mt-4 mb-2">Trienios ya disfrutadas/solicitadas:</label>
                            <input type="number" id="ld-trienios-taken-input" min="0" value="0" class="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-ugt-text-red focus:border-ugt-text-red transition">
                            <div class="mt-3 text-center">
                                <p class="text-slate-600">Restantes (Trienios):</p>
                                <p id="ld-trienios-remaining-days" class="text-2xl font-bold ugt-text-red">0 d√≠as</p>
                            </div>
                            <div class="mt-4 pt-4 border-t border-slate-200 text-center">
                                <p class="text-slate-600">Total Libre Disposici√≥n Restantes:</p>
                                <p id="ld-total-remaining-days" class="text-3xl font-bold ugt-text-red">0 d√≠as</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </main>
        
        <footer class="text-center mt-12 text-slate-600 text-sm">
            <p class="mb-2">Esta es una gu√≠a interpretativa no oficial.
                Para informaci√≥n vinculante, consulta siempre a tu sindicato UGT, la normativa vigente, las fuentes oficiales de SACYL y la Junta de Castilla y Le√≥n. Creado en 2025.</p>
            <div class="font-semibold ugt-text-red">
                <p>Secci√≥n sindical UGT</p>
                <p>Edificio 1, Hospital Virgen Vega, semis√≥tano</p>
                <p>C/ P.¬∞ de San Vicente, 58-182, 37007 Salamanca</p>
                <p>e-mail: <a href="mailto:sanidad.salamanca@ugt-sp.upt.org" class="underline ugt-text-red">sanidad.salamanca@ugt-sp.upt.org</a></p>
                <p>Tel. 923 29 1 00- Ext. 55598 y 55610</p>
            </div>
        </footer>

    </div>

    <!-- Embedded custom JavaScript -->
    <script>
        // script.js

        document.addEventListener('DOMContentLoaded', function () {
                    
            const nightHoursData = [
                { nights: 1, hours: 1529 }, { nights: 2, hours: 1525 }, { nights: 3, hours: 1528 },
                { nights: 4, hours: 1524 }, { nights: 5, hours: 1527 }, { nights: 6, hours: 1523 },
                { nights: 7, hours: 1526 }, { nights: 8, hours: 1522 }, { nights: 9, hours: 1525 },
                { nights: 10, hours: 1521 }, { nights: 11, hours: 1517 }, { nights: 12, hours: 1520 },
                { nights: 13, hours: 1516 }, { nights: 14, hours: 1519 }, { nights: 15, hours: 1515 },
                { nights: 16, hours: 1518 }, { nights: 17, hours: 1514 }, { nights: 18, hours: 1517 },
                { nights: 19, hours: 1513 }, { nights: 20, hours: 1516 }, { nights: 21, hours: 1512 },
                { nights: 22, hours: 1508 }, { nights: 23, hours: 1511 }, { nights: 24, hours: 1507 },
                { nights: 25, hours: 1510 }, { nights: 26, hours: 1506 }, { nights: 27, hours: 1509 },
                { nights: 28, hours: 1505 }, { nights: 29, hours: 1508 }, { nights: 30, hours: 1504 },
                { nights: 31, hours: 1507 }, { nights: 32, hours: 1503 }, { nights: 33, hours: 1499 },
                { nights: 34, hours: 1502 }, { nights: 35, hours: 1498 }, { nights: 36, hours: 1501 },
                { nights: 37, hours: 1497 }, { nights: 38, hours: 1500 }, { nights: 39, hours: 1496 },
                { nights: 40, hours: 1499 }, { nights: 41, hours: 1495 }, { nights: 42, hours: 1498 },
                { nights: 43, hours: 1494 }, { nights: 44, hours: 1490 }, { nights: 45, hours: 1493 },
                { nights: 46, hours: 1489 }, { nights: 47, hours: 1492 }, { nights: 48, hours: 1488 },
                { nights: 49, hours: 1491 }, { nights: 50, hours: 1487 }, { nights: 51, hours: 1490 },
                { nights: 52, hours: 1486 }, { nights: 53, hours: 1489 }, { nights: 54, hours: 1485 },
                { nights: 55, hours: 1488 }, { nights: 56, hours: 1484 }, { nights: 57, hours: 1480 },
                { nights: 58, hours: 1483 }, { nights: 59, hours: 1479 }, { nights: 60, hours: 1482 },
                { nights: 61, hours: 1478 }, { nights: 62, hours: 1481 }, { nights: 63, hours: 1477 },
                { nights: 64, hours: 1480 }, { nights: 65, hours: 1476 }, { nights: 66, hours: 1479 },
                { nights: 67, hours: 1475 }, { nights: 68, hours: 1478 }, { nights: 69, hours: 1474 },
                { nights: 70, hours: 1477 }, { nights: 71, hours: 1473 }, { nights: 72, hours: 1469 },
                { nights: 73, hours: 1472 }, { nights: 74, hours: 1468 }, { nights: 75, hours: 1471 },
                { nights: 76, hours: 1467 }, { nights: 77, hours: 1470 }, { nights: 78, hours: 1466 },
                { nights: 79, hours: 1469 }, { nights: 80, hours: 1465 }, { nights: 81, hours: 1468 },
                { nights: 82, hours: 1464 }, { nights: 83, hours: 1467 }, { nights: 84, hours: 1463 },
                { nights: 85, hours: 1466 }, { nights: 86, hours: 1462 }, { nights: 87, hours: 1458 },
                { nights: 88, hours: 1461 }, { nights: 89, hours: 1457 }, { nights: 90, hours: 1460 },
                { nights: 91, hours: 1456 }, { nights: 92, hours: 1459 }, { nights: 93, hours: 1455 },
                { nights: 94, hours: 1458 }, { nights: 95, hours: 1454 }, { nights: 96, hours: 1457 },
                { nights: 97, hours: 1453 }, { nights: 98, hours: 1456 }, { nights: 99, hours: 1452 },
                { nights: 100, hours: 1448 }, { nights: 101, hours: 1451 }, { nights: 102, hours: 1447 },
                { nights: 103, hours: 1450 }, { nights: 104, hours: 1446 }, { nights: 105, hours: 1449 },
                { nights: 106, hours: 1445 }, { nights: 107, hours: 1448 }, { nights: 108, hours: 1444 },
                { nights: 109, hours: 1447 }, { nights: 110, hours: 1443 }, { nights: 111, hours: 1446 },
                { nights: 112, hours: 1442 }, { nights: 113, hours: 1445 }, { nights: 114, hours: 1441 },
                { nights: 115, hours: 1437 }, { nights: 116, hours: 1440 }, { nights: 117, hours: 1436 },
                { nights: 118, hours: 1439 }, { nights: 119, hours: 1435 }, { nights: 120, hours: 1438 },
                { nights: 121, hours: 1434 }, { nights: 122, hours: 1437 }, { nights: 123, hours: 1433 },
                { nights: 124, hours: 1436 }, { nights: 125, hours: 1432 }, { nights: 126, hours: 1435 },
                { nights: 127, hours: 1431 }, { nights: 128, hours: 1434 }, { nights: 129, hours: 1430 },
                { nights: 130, hours: 1426 }, { nights: 131, hours: 1429 }, { nights: 132, hours: 1425 },
                { nights: 133, hours: 1428 }, { nights: 134, hours: 1424 }, { nights: 135, hours: 1427 },
                { nights: 136, hours: 1423 }, { nights: 137, hours: 1426 }, { nights: 138, hours: 1422 },
                { nights: 139, hours: 1425 }, { nights: 140, hours: 1421 }, { nights: 141, hours: 1424 },
                { nights: 142, hours: 1420 }
            ];

            const data = {
                shifts: [
                    { code: 'MAN', name: 'Ma√±anas (7h)', description: 'Turno de ma√±ana est√°ndar de 7 horas.' },
                    { code: 'MAA', name: 'Ma√±anas (7.5h)', description: 'Turno de ma√±ana de 7 horas y media.' },
                    { code: 'T', name: 'Tarde (7h)', description: 'Turno de tarde est√°ndar de 7 horas.' },
                    { code: 'TAA', name: 'Tarde (7.5h)', description: 'Turno de tarde de 7 horas y media.' },
                    { code: 'N', name: 'Noche (10h)', description: 'Turno de noche de 10 horas.' },
                    { code: 'MGH', name: 'Ma√±ana + Guardia F√≠sica', description: 'Turno combinado de 17 horas.' },
                    { code: 'MGL', name: 'Ma√±ana + Guardia Localizada', description: 'Turno combinado de 17 horas.' },
                    { code: 'MGF', name: 'Guardia F√≠sica (24h)', description: 'Guardia de presencia f√≠sica de 24 horas.' }
                ],
                vacationCodes: [
                    { code: 'VAC', name: 'Vacaciones' },
                    { code: 'VAA', name: 'Vac. por Antig√ºedad' },
                    { code: 'VAP', name: 'Vac. Pendientes' },
                    { code: 'VVP', name: 'Vac. Antig. Pendientes' },
                ],
                ldCodes: [
                    { code: 'LIB', name: 'Libre Disposici√≥n' },
                    { code: 'LDT', name: 'LD por Trienios' },
                    { code: 'LDN', name: 'LD A√±o Anterior' },
                    { code: 'LTA', name: 'LD Trienios A√±o Anterior' },
                ],
                permits: [
                    { name: 'Permiso por Maternidad', category: 'familiares', details: '16 semanas ininterrumpidas, ampliables.', codes: ['MAT'] },
                    { name: 'Permiso por Paternidad', category: 'familiares', details: '16 semanas (6 obligatorias post-parto).', codes: ['PAR'] },
                    { name: 'Permiso por Lactancia', category: 'familiares', details: '1h/d√≠a o acumulaci√≥n en 5 semanas.', codes: ['DLA'] },
                    { name: 'Cuidado de familiar (Enf. muy grave)', category: 'familiares', details: 'Reducci√≥n hasta 50% de jornada (m√°x. 1 mes).', codes: [] },
                    { name: 'Cuidado de hijo (Enf. grave)', category: 'familiares', details: 'Reducci√≥n de al menos 50% de jornada.', codes: [] },
                    { name: 'Permiso por Causa de Fuerza Mayor', category: 'familiares', details: '4 d√≠as (28 horas)/a√±o, no consecutivos.', codes: [] },
                    { name: 'Matrimonio o Pareja de Hecho', category: 'personales', details: '15 d√≠as naturales.', codes: [] },
                    { name: 'Traslado de Domicilio', category: 'personales', details: '1 d√≠a h√°bil.', codes: [] },
                    { name: 'Permiso por preparaci√≥n para donaci√≥n de √≥rganos o tejidos', category: 'salud', details: 'Tiempo indispensable para asistencia a sesiones de informaci√≥n, informes, ex√°menes cl√≠nicos y prestaci√≥n de consentimiento, siempre que sea durante la jornada de trabajo.', codes: [] },
                    { name: 'Asuntos Particulares (Libre Disposici√≥n)', category: 'personales', details: '6 d√≠as laborables por a√±o.', codes: ['LIB', 'LDN'] },
                    { name: 'Asuntos Particulares por Antig√ºedad', category: 'personales', details: '+2 d√≠as (6¬∫ trienio), +1 por trienio (desde el 8¬∫).', codes: ['LDT', 'LTA'] },
                    { name: 'Permiso sin sueldo (Asuntos Propios)', category: 'personales', details: 'M√°ximo 3 meses cada 2 a√±os.', codes: [] },
                    { name: 'Permiso Parental (Retribu√≠do seg√∫n √∫ltimas sentencias)', category: 'familiares', details: '8 semanas por hijos menores de 8 a√±os (en caso de duda consulta a tu sindicato).', codes: [] },
                    { name: 'Consulta M√©dica (propia o familiar)', category: 'salud', details: 'Tiempo indispensable y justificado.', codes: ['PCM'] },
                    { name: 'Fallecimiento de Familiar', category: 'familiares', details: '2-5 d√≠as h√°biles seg√∫n parentesco.', codes: ['FFA'] },
                    { name: 'Enfermedad sin baja (sin IT)', category: 'salud', details: 'Hasta 4 d√≠as/a√±o (m√°x. 3 consecutivos).', codes: ['ENF', 'ESB', 'ESN'] },
                    { name: 'Accidente Laboral/No Laboral', category: 'salud', details: 'Tiempo de baja seg√∫n prescripci√≥n.', codes: ['A'] },
                    { name: 'Asistencia a Ex√°menes Oficiales', category: 'formacion', details: 'D√≠a completo (finales) o tiempo indispensable (parciales).', codes: ['CON'] },
                    { name: 'Asistencia a Congresos', category: 'formacion', details: 'Tiempo indispensable, sujeto a necesidades.', codes: ['CON'] },
                    { code: 'DPI', name: 'Deber P√∫blico Inexcusable', category: 'formacion', details: 'Tiempo indispensable (citaciones, DNI, etc.).', codes: ['DPI'] },
                    { name: 'Compensaci√≥n por Solape', category: 'compensatorios', details: '1-7 d√≠as h√°biles/a√±o seg√∫n categor√≠a.', codes: ['C'] },
                    { name: 'Compensaci√≥n 24 y 31 de Diciembre', category: 'compensatorios', details: '7 horas por cada d√≠a para contratos en vigor que comprendan estas fechas.', codes: ['FEF'] },
                    { name: 'Compensaci√≥n S√°bados Festivos (Turno Ma√±ana Fija L-V)', category: 'compensatorios', details: 'Un d√≠a adicional por cada s√°bado festivo en el a√±o en curso para trabajadores con turno de ma√±anas fijas de lunes a viernes.', codes: ['D0H'] }
                ],
                aidaCodes: [
                    { code: "A", description: "ACCIDENTE LABORAL/NO LABORAL", category: "Ausencia", computo: "7" },
                    { code: "CON", description: "ASISTENCIA A CONGRESO", category: "Permiso", computo: "7" },
                    { code: "D", description: "DESCANSO", category: "Jornada/Descanso", computo: 0 },
                    { code: "DHU", description: "DIAS DE HUELGA", category: "Ausencia", computo: 0 },
                    { code: "D0H", description: "DESCANSO FESTIVO EN S√ÅBADO", category: "Jornada/Descanso", computo: 0 },
                    { code: "DLA", description: "DIAS LACTANCIA MATERNA", category: "Permiso", computo: 1 },
                    { code: "DPI", description: "DEBER P√öBLICO INEXCUSABLE", category: "Permiso", computo: 7 },
                    { code: "ENF", description: "ENFERMEDAD COM√öN/PROFESIONAL", category: "Ausencia", computo: 7 },
                    { code: "ESB", description: "ENFERMEDAD SIN BAJA", category: "Ausencia", computo: 7 },
                    { code: "ESN", description: "ENFERMEDAD SIN BAJA (REP. N√ìMINA)", category: "Ausencia", computo: 7 },
                    { code: "FEF", description: "COMPENSACI√ìN FESTIVO 24/31 DICIEMBRE", category: "Compensaci√≥n", computo: 7 },
                    { code: "FFA", description: "PERMISO FALLECIMIENTO", category: "Permiso", computo: 7 },
                    { code: "G09", description: "GUARDIAS 9 HORAS", category: "Turno", computo: 9 },
                    { code: "GRF", description: "GUARDIA 24 HORAS FORMACI√ìN", category: "Turno", computo: 24 },
                    { code: "LDN", description: "LIBRE DISPOSICI√ìN A√ëO ANTERIOR", category: "Permiso", computo: 7 },
                    { code: "LIB", description: "LIBRE DISPOSICI√ìN", category: "Permiso", computo: 7 },
                    { code: "LTA", description: "LIBRE DISPOSICI√ìN TRIENIOS A√ëO ANTERIOR", category: "Permiso", computo: 7 },
                    { code: "LDT", description: "LIBRE DISPOSICI√ìN TRIENIOS", category: "Permiso", computo: 7 },
                    { code: "LIS", description: "LIBERADO SINDICAL", category: "Permiso", computo: 7 },
                    { code: "MAN", description: "MA√ëANAS 7 HORAS", category: "Turno", computo: 7 },
                    { code: "MAA", description: "MA√ëANAS 7,30 HORAS", category: "Turno", computo: 7.5 },
                    { code: "MGF", description: "GUARDIA FISICA 24 HORAS", category: "Turno", computo: 24 },
                    { code: "MGH", description: "MA√ëANA+GUARDIA F√çSICA 17 HORAS", category: "Turno", computo: 17 },
                    { code: "MGL", description: "MA√ëANA+GUARDIA LOCALIZADA 17 HORAS", category: "Turno", computo: 17 },
                    { code: "MLG", description: "GUARDIA 24 HORAS LOCALIZADA", category: "Turno", computo: 24 },
                    { code: "MAT", description: "PERMISO MATERNIDAD", category: "Permiso", computo: 7 },
                    { code: "N", description: "NOCHE DE 10 HORAS", category: "Turno", computo: 10 },
                    { code: "PAR", description: "PERMISO PATERNIDAD", category: "Permiso", computo: 7 },
                    { code: "PCM", description: "PERMISO CONSULTA M√âDICA", category: "Permiso", computo: 4 },
                    { code: "PSC", description: "PERMISO SINDICAL COMPLETO", category: "Permiso", computo: 7 },
                    { code: "PSI", description: "PERMISO SINDICAL PARCIAL", category: "Permiso", computo: 4 },
                    { code: "MRG", description: "MA√ëANA+GUARDIA FORMACI√ìN 17 HORAS", category: "Turno", computo: 17 },
                    { code: "T", description: "TARDE DE 7 HORAS", category: "Turno", computo: 7 },
                    { code: "TAA", description: "TARDE DE 7,30 HORAS", category: "Turno", computo: 7.5 },
                    { code: "VAA", description: "DIAS VACACIONES POR ANTIG√úEDAD", category: "Vacaciones", computo: 7 },
                    { code: "VAC", description: "VACACIONES", category: "Vacaciones", computo: 7 },
                    { code: "VAP", description: "VACACIONES PENDIENTES A√ëO ANTERIOR", category: "Vacaciones", computo: 7 },
                    { code: "VVP", description: "VACACIONES ANTIG√úEDAD A√ëO ANTERIOR", category: "Vacaciones", computo: 7 }
                ].sort((a, b) => a.code.localeCompare(b.code))
            };

            const navButtons = document.querySelectorAll('.nav-btn');
            const tabContents = document.querySelectorAll('.tab-content');

            // Global Summary Logic elements (moved to top for better scope management)
            const summaryAntiquityYearsSpan = document.getElementById('summary-antiquity-years');
            const summaryVacationDaysSpan = document.getElementById('summary-vacation-days'); // Total entitlement for vacations
            const summaryLdDaysSpan = document.getElementById('summary-ld-days'); // Total entitlement for LD
            const summaryTotalDaysSpan = document.getElementById('summary-total-days'); // This will now show the total REMAINING days
            const summaryAntiquitySlider = document.getElementById('summary-antiquity-slider'); // New slider for summary

            // Elements for days taken/remaining
            const vacationBaseTakenInput = document.getElementById('vacation-base-taken-input');
            const vacationAntiquityTakenInput = document.getElementById('vacation-antiquity-taken-input');
            const vacationBaseRemainingDaysSpan = document.getElementById('vacation-base-remaining-days');
            const vacationAntiquityRemainingDaysSpan = document.getElementById('vacation-antiquity-remaining-days');
            const vacationTotalRemainingDaysSpan = document.getElementById('vacation-total-remaining-days');

            const ldBaseTakenInput = document.getElementById('ld-base-taken-input');
            const ldTrieniosTakenInput = document.getElementById('ld-trienios-taken-input');
            const ldBaseRemainingDaysSpan = document.getElementById('ld-base-remaining-days');
            const ldTrieniosRemainingDaysSpan = document.getElementById('ld-trienios-remaining-days');
            const ldTotalRemainingDaysSpan = document.getElementById('ld-total-remaining-days');


            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.dataset.tab;

                    navButtons.forEach(btn => {
                        btn.classList.remove('active-tab', 'highlight-nav-btn'); // Remove highlight from all
                        btn.classList.add('inactive-tab');
                        // Ensure existing highlight class is removed from others
                        if (btn.id === 'btn-resumen-global') {
                            btn.classList.remove('highlight-nav-btn');
                            btn.classList.add('inactive-tab'); // Revert to inactive if not selected
                        }
                    });
                    button.classList.add('active-tab');
                    button.classList.remove('inactive-tab');

                    // Re-add highlight specifically for the Resumen Global button if it's clicked
                    if (tabId === 'resumen-global') {
                        button.classList.add('highlight-nav-btn');
                    }


                    tabContents.forEach(content => {
                        if (content.id === `tab-${tabId}`) {
                            content.classList.remove('hidden');
                        } else {
                            content.classList.add('hidden');
                        }
                    });
                    // Special handling for charts to ensure they render correctly when their tab becomes visible
                    if (tabId === 'vacaciones') {
                        if (vacationChart) vacationChart.resize();
                    } else if (tabId === 'libre-disposicion') {
                        if (ldChart) ldChart.resize();
                    }
                    updateSummary(); // Update summary whenever a tab is clicked
                });
            });

            function populateShiftGrid() {
                const grid = document.getElementById('shift-grid');
                grid.innerHTML = data.shifts.map(shift => `
                    <div class="bg-slate-100 p-3 rounded-lg hover:bg-red-100 hover:shadow-md transition-all cursor-pointer border border-slate-200">
                        <p class="font-semibold ugt-text-red">${shift.name}</p>
                        <p class="text-xs font-mono bg-red-100 text-red-800 inline-block px-2 py-0.5 rounded mt-1">${shift.code}</p>
                        <p class="text-xs text-slate-500 mt-1">${shift.description}</p>
                    </div>
                `).join('');
            }

            function populateVacationCodesGrid() {
                const grid = document.getElementById('vacation-codes-grid');
                grid.innerHTML = data.vacationCodes.map(vc => `
                    <div class="bg-red-100 p-2 rounded border border-red-200">
                        <p class="font-semibold text-red-800">${vc.name}</p>
                        <p class="font-mono ugt-text-red bg-white inline-block px-1.5 rounded">${vc.code}</p>
                    </div>
                `).join('');
            }

            function populateLDCodesGrid() {
                const grid = document.getElementById('ld-codes-grid');
                grid.innerHTML = data.ldCodes.map(ldc => `
                    <div class="bg-red-100 p-2 rounded border border-red-200">
                        <p class="font-semibold text-red-800">${ldc.name}</p>
                        <p class="font-mono ugt-text-red bg-white inline-block px-1.5 rounded">${ldc.code}</p>
                    </div>
                `).join('');
            }
            
            const antiquitySlider = document.getElementById('antiquity-slider');
            const vacationAntiquityYearsSpan = document.getElementById('vacation-antiquity-years');
            const totalVacationDaysSpan = document.getElementById('total-vacation-days');
            const vacationChartCanvas = document.getElementById('vacation-chart');
            let vacationChart;
            let currentVacationDays = 0;

            function getVacationBonusDays(years) {
                if (years >= 30) return 4;
                if (years >= 25) return 3;
                if (years >= 20) return 2;
                if (years >= 15) return 1;
                return 0;
            }

            function updateVacationInfo() {
                const years = parseInt(antiquitySlider.value);
                const bonusDays = getVacationBonusDays(years);
                const baseDays = 22;
                currentVacationDays = baseDays + bonusDays;

                vacationAntiquityYearsSpan.textContent = years;
                totalVacationDaysSpan.textContent = `${currentVacationDays} d√≠as`; // Simplified this line
                
                if (vacationChart) {
                    vacationChart.data.datasets[0].data = [baseDays, bonusDays];
                    vacationChart.update();
                }
                updateSummary();
            }

            function initVacationChart() {
                const ctx = vacationChartCanvas.getContext('2d');
                vacationChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['D√≠as Base', 'D√≠as por Antig√ºedad'],
                        datasets: [{
                            label: 'D√≠as de Vacaciones',
                            data: [22, getVacationBonusDays(parseInt(antiquitySlider.value))],
                            backgroundColor: ['#E4002B', '#f87171'], /* UGT Red and lighter red */
                            borderColor: ['#c20025', '#E4002B'],
                            borderWidth: 1,
                            borderRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        indexAxis: 'y',
                        scales: {
                            x: {
                                beginAtZero: true,
                                grid: { display: false },
                                suggestedMax: 30
                            },
                            y: {
                                grid: { display: false }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.dataset.label}: ${context.raw}`;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            const antiquitySliderLd = document.getElementById('antiquity-slider-ld');
            const ldAntiquityYearsSpan = document.getElementById('ld-antiquity-years');
            const totalLdDaysSpan = document.getElementById('total-ld-days');
            const ldChartCanvas = document.getElementById('ld-chart');
            let ldChart;
            let currentLdDays = 0;

            function getPersonalDays(years) {
                let baseDays = 6;
                let bonusDays = 0;
                const trienios = Math.floor(years / 3);

                if (trienios >= 6) { // From 6th trienio (18 years)
                    bonusDays += 2;
                }
                // For each trienio starting from the 8th trienio (24 years), add 1 additional day.
                if (trienios >= 8) { 
                    bonusDays += (trienios - 7); 
                }
                return { base: baseDays, bonus: bonusDays, total: baseDays + bonusDays };
            }

            function updateLdInfo() {
                const years = parseInt(antiquitySliderLd.value);
                const ldData = getPersonalDays(years);
                currentLdDays = ldData.total;

                ldAntiquityYearsSpan.textContent = years;
                totalLdDaysSpan.textContent = `${currentLdDays} d√≠as`; // Simplified this line
                
                if (ldChart) {
                    ldChart.data.datasets[0].data = [ldData.base, ldData.bonus];
                    ldChart.update();
                }
                updateSummary();
            }

            function initLdChart() {
                const ctx = ldChartCanvas.getContext('2d');
                ldChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['D√≠as Base', 'D√≠as por Antig√ºedad'],
                        datasets: [{
                            label: 'D√≠as de Libre Disposici√≥n',
                            data: [6, getPersonalDays(parseInt(antiquitySliderLd.value)).bonus],
                            backgroundColor: ['#E4002B', '#f87171'], /* UGT Red and lighter red */
                            borderColor: ['#c20025', '#E4002B'],
                            borderWidth: 1,
                            borderRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        indexAxis: 'y',
                        scales: {
                            x: {
                                beginAtZero: true,
                                grid: { display: false },
                                suggestedMax: 15
                            },
                            y: {
                                grid: { display: false }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.dataset.label}: ${context.raw}`;
                                    }
                                }
                            }
                        }
                    }
                });
            }
            
            const permitList = document.getElementById('permit-list');
            const permitSearch = document.getElementById('permit-search');
            const permitCategoryFilter = document.getElementById('permit-category-filter');

            function renderPermits(filterText = '', category = 'all') {
                const filteredPermits = data.permits.filter(permit => {
                    // Ensure permit.name and permit.details exist before calling toLowerCase()
                    const permitName = permit.name ? permit.name.toLowerCase() : '';
                    const permitDetails = permit.details ? permit.details.toLowerCase() : '';

                    const matchesCategory = category === 'all' || permit.category === category;
                    const matchesText = permitName.includes(filterText.toLowerCase()) || permitDetails.includes(filterText.toLowerCase());
                    return matchesCategory && matchesText;
                });

                if (filteredPermits.length === 0) {
                    permitList.innerHTML = `<p class="text-slate-500 col-span-full text-center">No se encontraron permisos que coincidan con la b√∫squeda.</p>`;
                    return;
                }
                
                permitList.innerHTML = filteredPermits.map(permit => `
                    <div class="border ugt-border-red bg-ugt-accent-bg p-4 rounded-lg flex flex-col">
                        <h4 class="font-bold ugt-text-red">${permit.name}</h4>
                        <p class="text-sm text-slate-700 flex-grow mt-1">${permit.details}</p>
                        <div class="mt-3">
                            ${permit.codes.map(code => `<span class="text-xs font-mono bg-ugt-bg-red text-white px-2 py-1 rounded-full mr-1">${code}</span>`).join('')}
                        </div>
                    </div>
                `).join('');
            }
            
            const aidaCodeTableBody = document.getElementById('aida-code-table-body');
            const aidaCodeSearch = document.getElementById('aida-code-search');

            function renderAidaCodes(filterText = '') {
                const filteredCodes = data.aidaCodes.filter(item => 
                    item.code.toLowerCase().includes(filterText.toLowerCase()) ||
                    item.description.toLowerCase().includes(filterText.toLowerCase())
                );
                
                aidaCodeTableBody.innerHTML = filteredCodes.map(item => `
                    <tr class="bg-white border-b hover:bg-slate-50">
                        <td class="px-6 py-4 font-mono font-semibold ugt-text-red">${item.code}</td>
                        <td class="px-6 py-4">${item.description}</td>
                        <td class="px-6 py-4">
                            <span class="text-xs font-medium px-2 py-0.5 rounded-full ${
                                item.category === 'Turno' ? 'bg-blue-100 text-blue-800' :
                                item.category === 'Vacaciones' ? 'bg-green-100 text-green-800' :
                                item.category === 'Permiso' ? 'ugt-bg-red text-white' :
                                item.category === 'Compensaci√≥n' ? 'ugt-bg-red text-white' : /* Highlight Permiso and Compensaci√≥n */
                                'bg-slate-100 text-slate-800'
                            }">${item.category}</span>
                        </td>
                        <td class="px-6 py-4">${item.computo} horas</td> <!-- Added "horas" -->
                    </tr>
                `).join('');
            }

            function updateSummary() {
                const years = parseInt(summaryAntiquitySlider.value); // Use the new summary slider value
                summaryAntiquityYearsSpan.textContent = years;

                // Recalculate vacation days based on the summary slider
                const vacBonusEntitlement = getVacationBonusDays(years);
                const totalVacBaseEntitlement = 22;
                const totalVacEntitlement = totalVacBaseEntitlement + vacBonusEntitlement;
                summaryVacationDaysSpan.textContent = totalVacEntitlement; // Display total entitlement for vacations

                // Recalculate personal days based on the summary slider
                const ldData = getPersonalDays(years);
                const totalLdBaseEntitlement = ldData.base;
                const ldTrieniosEntitlement = ldData.bonus;
                const totalLdEntitlement = totalLdBaseEntitlement + ldTrieniosEntitlement;
                summaryLdDaysSpan.textContent = totalLdEntitlement; // Display total entitlement for LD

                // Calculate and display remaining days for each category
                const vacBaseTaken = parseInt(vacationBaseTakenInput.value) || 0;
                const vacAntiquityTaken = parseInt(vacationAntiquityTakenInput.value) || 0;
                const ldBaseTaken = parseInt(ldBaseTakenInput.value) || 0;
                const ldTrieniosTaken = parseInt(ldTrieniosTakenInput.value) || 0;

                const vacBaseRemaining = Math.max(0, totalVacBaseEntitlement - vacBaseTaken);
                const vacAntiquityRemaining = Math.max(0, vacBonusEntitlement - vacAntiquityTaken);
                const ldBaseRemaining = Math.max(0, totalLdBaseEntitlement - ldBaseTaken);
                const ldTrieniosRemaining = Math.max(0, ldTrieniosEntitlement - ldTrieniosTaken);

                // Debugging logs - useful for development, can be removed in production
                // console.log('--- updateSummary Debug ---');
                // console.log('Years:', years);
                // console.log('Vacation Base Entitlement:', totalVacBaseEntitlement);
                // console.log('Vacation Bonus Entitlement:', vacBonusEntitlement);
                // console.log('LD Base Entitlement:', totalLdBaseEntitlement);
                // console.log('LD Trienios Entitlement:', ldTrieniosEntitlement);
                // console.log('Vacation Base Taken:', vacBaseTaken);
                // console.log('Vacation Antiquity Taken:', vacAntiquityTaken);
                // console.log('LD Base Taken:', ldBaseTaken);
                // console.log('LD Trienios Taken:', ldTrieniosTaken);
                // console.log('Vacation Base Remaining:', vacBaseRemaining);
                // console.log('Vacation Antiquity Remaining:', vacAntiquityRemaining);
                // console.log('LD Base Remaining:', ldBaseRemaining);
                // console.log('LD Trienios Remaining:', ldTrieniosRemaining);
                const finalTotalRemaining = vacBaseRemaining + vacAntiquityRemaining + ldBaseRemaining + ldTrieniosRemaining;
                // console.log('Total Remaining (calculated):', finalTotalRemaining);
                // console.log('---------------------------');

                // Update UI for remaining days using textContent
                if (vacationBaseRemainingDaysSpan) {
                    vacationBaseRemainingDaysSpan.textContent = `${vacBaseRemaining} d√≠as`;
                }
                if (vacationAntiquityRemainingDaysSpan) {
                    vacationAntiquityRemainingDaysSpan.textContent = `${vacAntiquityRemaining} d√≠as`;
                }
                if (vacationTotalRemainingDaysSpan) {
                    vacationTotalRemainingDaysSpan.textContent = `${vacBaseRemaining + vacAntiquityRemaining} d√≠as`;
                }

                if (ldBaseRemainingDaysSpan) {
                    ldBaseRemainingDaysSpan.textContent = `${ldBaseRemaining} d√≠as`;
                }
                if (ldTrieniosRemainingDaysSpan) {
                    ldTrieniosRemainingDaysSpan.textContent = `${ldTrieniosRemaining} d√≠as`;
                }
                if (ldTotalRemainingDaysSpan) {
                    ldTotalRemainingDaysSpan.textContent = `${ldBaseRemaining + ldTrieniosRemaining} d√≠as`;
                }
                
                // Update the main "Total D√≠as de Descanso" to show the sum of all remaining days
                summaryTotalDaysSpan.textContent = finalTotalRemaining;
            }

            // Night Shift Calculation Logic
            const nightShiftsInput = document.getElementById('night-shifts-input');
            const adjustedAnnualHoursSpan = document.getElementById('adjusted-annual-hours');
            const nightShiftMessage = document.getElementById('night-shift-message');

            function calculateAnnualHours() {
                const numberOfNights = parseInt(nightShiftsInput.value);
                // Updated base annual hours for diurno/fixed morning shifts
                const baseAnnualHoursDiurno = 1533; 

                if (isNaN(numberOfNights) || numberOfNights < 0) {
                    adjustedAnnualHoursSpan.textContent = `${baseAnnualHoursDiurno} horas`;
                    nightShiftMessage.textContent = "Introduce un n√∫mero v√°lido de noches.";
                    return;
                }

                if (numberOfNights === 0) {
                    adjustedAnnualHoursSpan.textContent = `${baseAnnualHoursDiurno} horas`;
                    nightShiftMessage.textContent = "Para turno diurno o sin noches, la jornada base es 1.533 horas.";
                } else if (numberOfNights >= 1 && numberOfNights <= 142) {
                    const foundData = nightHoursData.find(item => item.nights === numberOfNights);
                    if (foundData) {
                        adjustedAnnualHoursSpan.textContent = `${foundData.hours} horas`;
                        nightShiftMessage.textContent = `Jornada seg√∫n tabla oficial del BOCYL para ${numberOfNights} noches.`;
                    } else {
                        // This case should ideally not be hit if input max/min are set correctly and data is complete
                        adjustedAnnualHoursSpan.textContent = `${baseAnnualHoursDiurno} horas`;
                        nightShiftMessage.textContent = `No se encontr√≥ un valor exacto para ${numberOfNights} noches en la tabla.`;
                    }
                } else {
                    adjustedAnnualHoursSpan.textContent = `N/A`;
                    nightShiftMessage.textContent = "El n√∫mero de noches est√° fuera del rango (1-142) de la tabla oficial.";
                }
            }

            // Function to create dynamic labels for the slider
            function createDynamicSliderLabels(labelsContainerId, min, max, step) {
                const labelsContainerElement = document.getElementById(labelsContainerId);
                if (!labelsContainerElement) return;

                labelsContainerElement.innerHTML = ''; // Clear existing labels

                const labelsToShow = new Set();
                labelsToShow.add(min); // Always add min

                for (let i = min; i <= max; i += step) {
                    labelsToShow.add(i);
                }
                labelsToShow.add(max); // Always add max

                // Sort and add labels to the container
                Array.from(labelsToShow).sort((a, b) => a - b).forEach(labelValue => {
                    const span = document.createElement('span');
                    span.textContent = labelValue;
                    labelsContainerElement.appendChild(span);
                });
            }


            antiquitySlider.addEventListener('input', () => {
                const value = antiquitySlider.value;
                antiquitySliderLd.value = value; // Sync sliders
                summaryAntiquitySlider.value = value; // Sync with new summary slider
                updateVacationInfo();
                updateLdInfo();
            });
            antiquitySliderLd.addEventListener('input', () => {
                const value = antiquitySliderLd.value;
                antiquitySlider.value = value; // Sync sliders
                summaryAntiquitySlider.value = value; // Sync with new summary slider
                updateLdInfo();
                updateVacationInfo();
            });
            // New event listener for the summary antiquity slider
            summaryAntiquitySlider.addEventListener('input', () => {
                const value = summaryAntiquitySlider.value;
                antiquitySlider.value = value; // Sync with other sliders
                antiquitySliderLd.value = value; // Sync with other sliders
                updateVacationInfo(); // Recalculate vacation info based on new value
                updateLdInfo(); // Recalculate LD info based on new value
                updateSummary(); // Update the summary section
            });


            nightShiftsInput.addEventListener('input', calculateAnnualHours); // New event listener

            permitSearch.addEventListener('input', () => renderPermits(permitSearch.value, permitCategoryFilter.value));
            permitCategoryFilter.addEventListener('change', () => renderPermits(permitSearch.value, permitCategoryFilter.value));
            aidaCodeSearch.addEventListener('input', () => renderAidaCodes(aidaCodeSearch.value));

            // New event listeners for the "taken" inputs
            vacationBaseTakenInput.addEventListener('input', updateSummary);
            vacationAntiquityTakenInput.addEventListener('input', updateSummary);
            ldBaseTakenInput.addEventListener('input', updateSummary);
            ldTrieniosTakenInput.addEventListener('input', updateSummary);
            
            // Initial calls
            populateShiftGrid();
            populateVacationCodesGrid();
            populateLDCodesGrid();
            initVacationChart();
            initLdChart();
            
            // Populate dynamic slider labels
            createDynamicSliderLabels('vacation-slider-labels', 0, 50, 5); // Labels for 0, 5, 10, ..., 45, 50
            createDynamicSliderLabels('ld-slider-labels', 0, 50, 5); // Labels for 0, 5, 10, ..., 45, 50
            createDynamicSliderLabels('summary-slider-labels', 0, 50, 5); // Labels for the new summary slider

            updateVacationInfo(); // Initial update for vacation and summary
            updateLdInfo(); // Initial update for LD and summary
            calculateAnnualHours(); // Initial calculation for annual hours
            renderPermits();
            renderAidaCodes();
            updateSummary(); // Ensure summary is updated on load
        });
    </script>
</body>
</html>
